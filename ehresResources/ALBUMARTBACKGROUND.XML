<Mcml xmlns ="http://schemas.microsoft.com/2006/mcml" xmlns:cor ="assembly://MsCorLib/System" xmlns:col ="assembly://MsCorLib/System.Collections" xmlns:shell ="assembly://Microsoft.MediaCenter.Shell/Microsoft.MediaCenter.Shell" xmlns:audio ="assembly://ehshell/MediaCenter.Audio" xmlns:me ="Me" ><UI Name="AlbumArtBackground"><Properties><Image Name="MaskImage" Image="res://ehres!StartMask.Overlay.png"/><audio:AlbumArtBackground Name="MosaicBackgroundType" /></Properties><Locals><audio:AlbumArtBackground Name="MosaicBackground" AlbumArtBackground="[MosaicBackgroundType!audio:AlbumArtBackground.Instance]" /><Environment Name="Environment"/><Timer Name="TimerForInitialization" Interval="1000" Enabled="true" AutoRepeat="true"/><Timer Name="TimerForScrolling" Interval="2000" Enabled="false" AutoRepeat="true"/><Image Name="BackgroundImage" Image="res://ehres!Common.Background.png" Flippable="false"/><cor:Random Name="Random" /><cor:Boolean Name="CanShowMosaic" Boolean="false" /><ArrayListDataSet Name="FakeData"><Source><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /></Source></ArrayListDataSet></Locals><Rules><Rule><Conditions><IsValid Source="[MaskImage]" /><Modified Source="[MosaicBackground.HasMask]" InitialEvaluate="true" /><Equality Source="[MosaicBackground.HasMask]" ConditionOp="Equals" Value="true" /></Conditions><Actions><Set Value="[MaskImage]" Target="[MaskOverlay.Content]" /></Actions></Rule><Default Target="[MaskOverlay.Content]" Value="null" /><Rule><Conditions><Equality Source="[MosaicBackgroundType!audio:AlbumArtBackground.ShouldScanFolders]" ConditionOp="Equals" Value="true" /></Conditions><Actions><Invoke Target="[MosaicBackground.SearchForAlbumArt]"/></Actions></Rule><Changed Source="[TimerForInitialization.Tick]" InitialEvaluate="false" ><Conditions><IsValid Source="[MosaicBackground.AlbumCovers]" /><Equality Source="[MosaicBackground.AlbumCovers.Count]" ConditionOp="GreaterThanOrEquals" Value="[MosaicBackground.MinAlbumCoversRequired]" /></Conditions><Actions><Set Target="[CanShowMosaic]" Value="true" /><Set Target="[TimerForInitialization.Enabled]" Value="false" /><Set Target="[TimerForScrolling.Enabled]" Value="true" /></Actions></Changed><Binding Source="[CanShowMosaic]" Target="[VerticalScroller.Visible]" /><Changed Source="[TimerForScrolling.Tick]" InitialEvaluate="false" ><Conditions><Equality Source="[MosaicBackground.UseFlippingAnimationMode]" ConditionOp="Equals" Value="false" /></Conditions><Actions><Invoke Target="[VerticalScroller.ScrollingData.Scroll]" amount="-4" /></Actions></Changed></Rules><Content><Graphic Content="[BackgroundImage]"><Children><Graphic Name="MaskOverlay" Image="null" Layout="Fill" ><Animations><Animation Type="ContentChangeShow" Intensity="Intensive"><Keyframes><AlphaKeyframe Time="0" Value="0"/><AlphaKeyframe Time=".5" Value="1"/></Keyframes></Animation><Animation Type="ContentChangeHide" Intensity="Intensive"><Keyframes><AlphaKeyframe Time="0" Value="1"/><AlphaKeyframe Time=".5" Value="0"/></Keyframes></Animation></Animations></Graphic><Scroller Name="VerticalScroller" Orientation="Vertical" Prefetch="0.15"><Children><Repeater Name="RowRepeater" Source="[FakeData]" DiscardOffscreenVisuals="true" ><Layout><GridLayout Orientation="Vertical" Spacing="0,0" RepeatGap="0" AllowWrap="false" Repeat="Always" Columns="1"/></Layout><Content><me:MosaicRow MosaicBackground="[MosaicBackground]" Random="[Random]" MaximumSize="0,124" MinimumSize="0,124" Layout="Fill"/></Content><Animations><Animation Type="Move"><Keyframes><PositionKeyframe Time="0.0" RelativeTo="Current" /><PositionKeyframe Time="2.0" RelativeTo="Final" /></Keyframes></Animation></Animations></Repeater></Children></Scroller></Children></Graphic></Content></UI><UI Name="MosaicRow"><Properties><audio:AlbumArtBackground Name="MosaicBackground" AlbumArtBackground="$Required" /><cor:Random Name="Random" Random="$Required" /><ArrayListDataSet Name="FakeData"><Source><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /><cor:String String="1" /></Source></ArrayListDataSet></Properties><Content><Panel Layout="Form"><Children><Repeater Name="ColumnRepeater" Source="[FakeData]" ><LayoutInput><FormLayoutInput ContributesToWidth="false" Left="Parent,0,-100" Right="Parent,1,200"/></LayoutInput><Layout><GridLayout Spacing="0,0" AllowWrap="false" Orientation="Horizontal" ReferenceSize="124,124" MajorAlignment="Fill" MinorAlignment="Fill" /></Layout><Content><me:AlbumCoverItem MosaicBackground="[MosaicBackground]" Random="[Random]" /></Content></Repeater></Children></Panel></Content></UI><UI Name="AlbumCoverItem"><Properties><audio:AlbumArtBackground Name="MosaicBackground" AlbumArtBackground="$Required" /><Image Name="AlbumCoverShadow" Source="res://ehres!Audio.NowPlaying.Mosaic.DropShadow.png" Flippable="true" /><cor:Random Name="Random" Random="$Required" /></Properties><Locals><Environment Name="Environment"/><cor:Int32 Name="MaxDelay" Int32="3000" /><cor:Int32 Name="PikaFlipInterval" Int32="300000" /><cor:Int32 Name="DropHesitation" /><cor:Int32 Name="IndexInSource" Int32="-1" /><cor:Object Name="Result" Object="null" /><Timer Name="GridPopulationTimer" Enabled="false" AutoRepeat="false" /><Timer Name="AlbumReplacementTimer" Enabled="false" AutoRepeat="false" /><MathTransformer Name="TimerMod" Mod="20"/><MathTransformer Name="Milliseconds" Multiply="1000"/></Locals><Rules><Rule><Conditions><Equality Source="[MosaicBackground.UseFlippingAnimationMode]" ConditionOp="Equals" Value="true" /></Conditions><Actions><Invoke Target="[Random.Next]" minValue="30000" maxValue="[PikaFlipInterval]" ResultTarget="[DropHesitation]" ExclusiveApply="false" InvokePolicy="Synchronous" /><Set Target="[AlbumReplacementTimer.Interval]" Value="[DropHesitation]" InvokePolicy="Synchronous" /><Set Target="[AlbumReplacementTimer.Enabled]" Value="true" /></Actions></Rule><Changed Source="[GridPopulationTimer.Tick]" InitialEvaluate="false"><Conditions><IsValid Source="[MosaicBackground]" /></Conditions><Actions><Set Target="[GridPopulationTimer.Enabled]" Value="false" /><Set Target="[AlbumGraphicPanel.Parent.Layer]" Value="[MosaicBackground.AlbumTileCount]" InvokePolicy="Synchronous"/><Invoke Target="[MosaicBackground.AlbumCovers.get_Item]" index="[IndexInSource]" ResultTarget="[Result]" InvokePolicy="Synchronous" /><Set Target="[AlbumGraphic.Content]" Value="[Result!audio:AlbumArtItem.AlbumCoverImage]" InvokePolicy="Synchronous" ExclusiveApply="false" /><Set Target="[AlbumGraphicShadow.Content]" Value="[AlbumCoverShadow]" InvokePolicy="Synchronous" ExclusiveApply="false" /></Actions></Changed><Changed Source="[AlbumReplacementTimer.Tick]" InitialEvaluate="false"><Conditions><Equality Source="[MosaicBackground.UseFlippingAnimationMode]" ConditionOp="Equals" Value="true" /><IsValid Source="[MosaicBackground]" /></Conditions><Actions><Invoke Target="[AlbumGraphic.DetachAnimation]" type="ContentChangeShow" InvokePolicy="Synchronous" ExclusiveApply="false" /><Invoke Target="[AlbumGraphic.AttachAnimation]" animation="animation://me:PikaCover.ContentChangeShow" InvokePolicy="Synchronous" ExclusiveApply="false"/><Invoke Target="[AlbumGraphic.AttachAnimation]" animation="animation://me:PikaCover.ContentChangeHide" InvokePolicy="Synchronous" ExclusiveApply="false"/><Set Target="[IndexInSource]" Value="[MosaicBackground.RandomAlbumCoverIndex]" InvokePolicy="Synchronous"/><Invoke Target="[MosaicBackground.AlbumCovers.get_Item]" index="[IndexInSource]" ResultTarget="[Result]" InvokePolicy="Synchronous" /><Set Target="[AlbumGraphic.Content]" Value="[Result!audio:AlbumArtItem.AlbumCoverImage]" InvokePolicy="Synchronous" ExclusiveApply="false" /><Invoke Target="[Random.Next]" minValue="30000" maxValue="[PikaFlipInterval]" ResultTarget="[DropHesitation]" ExclusiveApply="false" InvokePolicy="Synchronous" /><Set Target="[AlbumReplacementTimer.Interval]" Value="[DropHesitation]" InvokePolicy="Synchronous" /><Set Target="[AlbumReplacementTimer.Enabled]" Value="true" InvokePolicy="Synchronous" /></Actions></Changed><Rule><Conditions><Equality Source="[AlbumGraphic.Content]" Value="null"/><Equality Source="[Environment.Is2DAnimationExperience]" Value="true"/></Conditions><Actions><Invoke Target="[AlbumGraphic.DetachAnimation]" type="ContentChangeShow" InvokePolicy="Synchronous" ExclusiveApply="false" /><Set Target="[IndexInSource]" Value="[MosaicBackground.RandomAlbumCoverIndex]" InvokePolicy="Synchronous"/><Set Target="[GridPopulationTimer.Enabled]" Value="false" /><Invoke Target="[MosaicBackground.AlbumCovers.get_Item]" index="[IndexInSource]" ResultTarget="[Result]" InvokePolicy="Synchronous" /><Set Target="[AlbumGraphic.Content]" Value="[Result!audio:AlbumArtItem.AlbumCoverImage]" InvokePolicy="Synchronous" ExclusiveApply="false" /><Set Target="[AlbumGraphicShadow.Content]" Value="[AlbumCoverShadow]" InvokePolicy="Synchronous" ExclusiveApply="false" /></Actions></Rule><Rule><Conditions><Equality Source="[AlbumGraphic.Content]" Value="null"/><Equality Source="[Environment.Is2DAnimationExperience]" Value="false"/></Conditions><Actions><Set Target="[IndexInSource]" Value="[MosaicBackground.RandomAlbumCoverIndex]" InvokePolicy="Synchronous"/><Invoke Target="[Random.Next]" maxValue="[MaxDelay]" ResultTarget="[DropHesitation]" ExclusiveApply="false" InvokePolicy="Synchronous" /><Set Target="[GridPopulationTimer.Interval]" Value="[DropHesitation]" InvokePolicy="Synchronous" /><Set Target="[GridPopulationTimer.Enabled]" Value="true" /></Actions></Rule></Rules><Content><Panel Name="AlbumGraphicPanel" MaximumSize="124,124" MinimumSize="124,124"><Children><Graphic Name="AlbumGraphic" Layout="Anchor" MaximumSize="124,124" MinimumSize="124,124" CenterPointPercent="0.5,0.5,0.5"><Children><Graphic Name="AlbumGraphicShadow" Margins="-19,-19,-19,-19" CenterPointPercent="0.5,0.5,0.5" /></Children><Animations><Animation Type="ContentChangeShow"><Keyframes><AlphaKeyframe Time="0.0" Value="0"/><ScaleKeyframe Time="0.0" Value="1.2,1.2,0" /><AlphaKeyframe Time="0.5" Value="1"/><ScaleKeyframe Time="1.5" Value="1,1,0" /></Keyframes></Animation></Animations></Graphic></Children></Panel></Content></UI><Animation Name="PikaCover.ContentChangeHide" Type="ContentChangeHide"><Keyframes><AlphaKeyframe Time="0.0" Value="1"/><AlphaKeyframe Time="0.5" Value="0"/></Keyframes></Animation><Animation Name="PikaCover.ContentChangeShow" Type="ContentChangeShow"><Keyframes><AlphaKeyframe Time="0.0" Value="0"/><AlphaKeyframe Time="0.5" Value="1"/></Keyframes></Animation></Mcml>