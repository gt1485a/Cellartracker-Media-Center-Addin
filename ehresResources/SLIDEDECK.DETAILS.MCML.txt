<Mcml xmlns ="http://schemas.microsoft.com/2006/mcml" xmlns:cor ="assembly://MSCorLib/System" xmlns:draw="assembly://Microsoft.MediaCenter.UI/Microsoft.MediaCenter.UI.Drawing" xmlns:shl="assembly://Microsoft.MediaCenter.Shell/Microsoft.MediaCenter.Shell" xmlns:comm="res://Microsoft.MediaCenter.Shell!Globals.mcml" xmlns:ctl="res://Microsoft.MediaCenter.Shell!Controls.mcml" xmlns:base="res://Microsoft.MediaCenter.Shell!SlideDeck.mcml" xmlns:anim="res://Microsoft.MediaCenter.Shell!SlideAnimations.mcml" xmlns:slide="res://Microsoft.MediaCenter.Shell!Slide.mcml" xmlns:ucp="assembly://ehshell/ServiceBus.UIFramework" xmlns:me ="Me"><Image Name="SlideBackgroundStripeImage" Source="res://ehres!Slide.Background.Stripe.png" Flippable="true"/><Image Name="BodyPaneImage" Source="res://ehres!Details.Body.Pane.png" Flippable="true"/><Image Name="CommandButtonGradientImage" Source="res://ehres!Details.Command.Button.Gradient.png" Flippable="true"/><Image Name="ShadowLeft" Source="res://ehres!Slide.Shadow.Left.png" Flippable="true"/><Image Name="ShadowRight" Source="res://ehres!Slide.Shadow.Right.png" Flippable="true"/><UI Name="SlideDeck_Details_Overlay" BaseUI="base:SlideDeck_Base"><Properties><Font Name="TitleFont" FontName="global://comm:MainFontFace" FontSize="20"/><Font Name="DataFont" FontName="global://comm:RegularFontFace" FontSize="18"/><Color Name="TitleColor" Color="color://comm:OffWhite"/><Color Name="DataColor" Color="color://comm:OffWhite"/><Font Name="AlertFont" FontName="global://comm:MainFontFace" FontSize="16"/><shl:PageState Name="PageState" PageState="null"/></Properties><Locals><Environment Name="Environment"/><shl:ShellData Name="ShellData"/><AnchorEdge Name="ShadowAnchorLeft" Id="Parent" Percent="0.5" Offset="-403"/><AnchorEdge Name="ShadowAnchorRight" Id="Parent" Percent="0.5" Offset="403"/><cor:Boolean Name="PageRespectsOverscan" Boolean="true"/><Vector3 Name="HorizontalOverscanCompensation" Vector3="1,1,1"/></Locals><Rules><Default Target="[Accessible.Role]" Value="Pane" /><Binding Target="[Accessible.Name]" Source="[SlideDeck.Context]"><Conditions><IsValid Source="[SlideDeck]"/></Conditions><Transformer><FormatTransformer Format="SlideDeck/{0}" /></Transformer></Binding><Rule><Conditions><IsValid Source="[SlideDeck.Options]"/><Equality Source="[SlideDeck.Options.Count]" Value="2" ConditionOp="GreaterThan"/></Conditions><Actions><Set Target="[SlideDeck.Wrap]" Value="true"/></Actions></Rule><Condition Source="[Environment.ColorScheme]" ConditionOp="NotEquals" SourceValue="Default" Target="[CommandButtonGradient.Visible]" Value="false" /><Condition Source="[Environment.ColorScheme]" ConditionOp="NotEquals" SourceValue="Default" Target="[BodyPane.Visible]" Value="false" /><Condition Source="[Environment.ColorScheme]" ConditionOp="NotEquals" SourceValue="Default" Target="[BodyPaneColorFill.Visible]" Value="true" /><Default Target="[Accessible.Name]" Value="SlideDeck" /><Default Target="[SlideDeck.Wrap]" Value="false" /><Rule><Conditions><IsValid Source="[PageState]"/><Equality Source="[PageState.RespectOverscanMargins]" Value="false"/></Conditions><Actions><Set Target="[PageRespectsOverscan]" Value="false"/></Actions></Rule><Rule><Conditions><IsValid Source="[PageState]" /><Equality Source="[PageState.TransitionState]" Value="NavigatingToBackward" /></Conditions><Actions><Invoke Target="[SlideTitlePanel.DetachAnimation]" type="Show" InvokePolicy="Synchronous" ExclusiveApply="false" /><Set Target="[SlideHost.AnimationSlideIn]" Value="animation://anim:Slide.Show" InvokePolicy="Synchronous" ExclusiveApply="false" /></Actions></Rule><Rule><Conditions><Modified Source="[SlideDeck.OnNavigatedAway]" /></Conditions><Actions><Invoke Target="[SlideTitlePanel.DetachAnimation]" type="Show" InvokePolicy="Synchronous" ExclusiveApply="false" /><Set Target="[SlideHost.AnimationSlideIn]" Value="animation://anim:Slide.Show" InvokePolicy="Synchronous" ExclusiveApply="false" /></Actions></Rule><Binding Target="[MainPanel.Scale]" Source="[ShellData.OverscanScale]"><Conditions><Equality Source="[PageRespectsOverscan]" Value="false"/></Conditions></Binding><Binding Target="[HorizontalOverscanCompensation.X]" Source="[ShellData.OverscanScale.X]"><Conditions><Equality Source="[PageRespectsOverscan]" Value="false"/></Conditions></Binding><Rule><Conditions><Equality Source="[PageRespectsOverscan]" Value="false"/><Equality Source="[HorizontalOverscanCompensation.X]" Value="1" ConditionOp="NotEquals"/></Conditions><Actions><Set Target="[SlideBackgroundStripe.Scale]" Value="[HorizontalOverscanCompensation]"/><Set Target="[CommandButtonGradient.Scale]" Value="[HorizontalOverscanCompensation]"/><Set Target="[BodyPane.Scale]" Value="[HorizontalOverscanCompensation]"/><Set Target="[BodyPaneColorFill.Scale]" Value="[HorizontalOverscanCompensation]"/><Set Target="[ShadowAnchorLeft.Offset]" Value="-366"/><Set Target="[ShadowAnchorRight.Offset]" Value="366"/></Actions></Rule></Rules><Content><Panel Name="SlideDeckForm" Layout="Form"><Animations><Animation Animation="animation://anim:SlideDeck.SwoopIn.Show"/><Animation Animation="animation://anim:SlideDeck.SwoopIn.Hide"/></Animations><Children><base:ActiveSurface DismissCmd="[CommandClearOverlays]"><LayoutInput><AnchorLayoutInput Right="LeftShadow,0" /></LayoutInput></base:ActiveSurface><base:ActiveSurface DismissCmd="[CommandClearOverlays]"><LayoutInput><AnchorLayoutInput Left="RightShadow,1" /></LayoutInput></base:ActiveSurface><Panel Name="MainPanel" Layout="Anchor" CenterPointPercent="0.5,0.5,1"><LayoutInput><AnchorLayoutInput Left="Parent,0.5,-403" Top="Parent,0" Bottom="Parent,1" Right="Parent,0.5,403"/></LayoutInput><Children><Clip Name="SlideClip" FadeSize="30" Orientation="Horizontal" Margins="10,0,0,0" Layout="Anchor"><LayoutInput><AnchorLayoutInput Left="Parent,0" Top="Parent,0" Right="Parent,1" Bottom="Parent,1"/></LayoutInput><Children><base:ErrorsList Name="ErrorLayer" Visible="false" /><slide:NavPanel Name="NavPanel" Layout="Anchor" SlideDeck="[SlideDeck]"><LayoutInput><AnchorLayoutInput Top="Parent,0,59" Right="Parent,1,-27"/></LayoutInput></slide:NavPanel><me:HelperKeyInteractive><LayoutInput><AnchorLayoutInput Top="Parent,0" Right="Parent,1"/></LayoutInput></me:HelperKeyInteractive><me:SlideTitlePanel Name="SlideTitlePanel" Layout="Anchor" SlideDeck="[SlideDeck!ucp:OverlaySlideDeck]" ><Animations><Animation Animation="animation://anim:SlideTitlePivot.NavRight.Show"/></Animations><LayoutInput><AnchorLayoutInput Left="Parent,0,71" Top="Parent,0,15" Right="Parent,1,-140"/></LayoutInput></me:SlideTitlePanel><slide:Slide_Base Name="SlideHost" SlideDeck="[SlideDeck]" ThrowOnLoadError="false" CommandPopOverlay="[CommandPopOverlay]" CommandClearOverlays="[CommandClearOverlays]" MaximumSize="806,0"><LayoutInput><AnchorLayoutInput Left="Parent,0" Top="Parent,0" Right="Parent,1" Bottom="Parent,1"/></LayoutInput></slide:Slide_Base></Children></Clip></Children></Panel><me:ActiveShadow Name="LeftShadow" DismissCmd="[CommandClearOverlays]" GraphicSource="image://me:ShadowLeft" ><LayoutInput><AnchorLayoutInput Top="Parent,0,-100" Right="[ShadowAnchorLeft]" Bottom="Parent,1,100"/></LayoutInput></me:ActiveShadow><me:ActiveShadow Name="RightShadow" DismissCmd="[CommandClearOverlays]" GraphicSource="image://me:ShadowRight"><LayoutInput><AnchorLayoutInput Left="[ShadowAnchorRight]" Top="Parent,0,-100" Bottom="Parent,1,100"/></LayoutInput></me:ActiveShadow><Graphic Name="SlideBackgroundStripe" Content="image://me:SlideBackgroundStripeImage" CenterPointPercent="0.5,0.5,1" ><LayoutInput><AnchorLayoutInput Left="MainPanel,0" Top="Parent,0,-100" Right="MainPanel,1" Bottom="Parent,0,263"/></LayoutInput></Graphic><Graphic Name="CommandButtonGradient" Content="image://me:CommandButtonGradientImage" CenterPointPercent="0.5,0.5,1"><LayoutInput><AnchorLayoutInput Left="MainPanel,0" Top="SlideBackgroundStripe,1" Right="MainPanel,1" Bottom="Parent,0,608"/></LayoutInput></Graphic><Graphic Name="BodyPane" Content="image://me:BodyPaneImage" CenterPointPercent="0.5,0.5,1"><LayoutInput><AnchorLayoutInput Left="MainPanel,0" Top="SlideBackgroundStripe,1" Right="MainPanel,1" Bottom="Parent,1,100"/></LayoutInput></Graphic><ColorFill Name="BodyPaneColorFill" Content="color://comm:MediumBlue98Percent" Visible="false" CenterPointPercent="0.5,0.5,1"><LayoutInput><AnchorLayoutInput Left="MainPanel,0" Top="SlideBackgroundStripe,1" Right="MainPanel,1" Bottom="Parent,1,100"/></LayoutInput></ColorFill></Children></Panel></Content></UI><UI Name="ActiveShadow"><Locals><ClickHandler Name="Clicker"/></Locals><Properties><Image Name="GraphicSource" Image="$Required"/><ICommand Name="DismissCmd" ICommand="$Required"/></Properties><Rules><Default Target="[Input.KeyInteractive]" Value="false" /><Default Target="[Input.MouseInteractive]" Value="true" /><Default Target="[Input.KeyFocusOnMouseEnter]" Value="false" /><Binding Source="[DismissCmd]" Target="[Clicker.Command]"/></Rules><Content><Graphic Content="[GraphicSource]" MaintainAspectRatio="false"/></Content></UI><UI Name="HelperKeyInteractive"><Rules><Default Target="[Input.KeyInteractive]" Value="false" /><Default Target="[Input.MouseInteractive]" Value="true" /></Rules><Content><Panel MinimumSize="138,97" MaximumSize="138,97"><LayoutInput><AnchorLayoutInput Top="Parent,0" Right="Parent,1"/></LayoutInput></Panel></Content></UI><UI Name="SlideTitlePanel"><Properties><ucp:OverlaySlideDeck Name="SlideDeck" OverlaySlideDeck="$Required" /><Font Name="SelectedItemFont" FontName="global://comm:LightFontFace" FontSize="48"/><Font Name="ItemFont" FontName="global://comm:LightFontFace" FontSize="30"/><cor:Single Name="FadeSize" Single="50" /><Color Name="ItemColor" Color="color://comm:OffWhite"/><Inset Name="ItemMargins" Inset="0,0,36,6"/></Properties><Locals><ScrollingData Name="ScrollingData" LockedPosition="0" LockedAlignment="0" /><ScrollingHandler Name="ScrollingHandler" HandlerStage="Bubbled"/><FlowLayout Name="FlowLayout" Orientation="Horizontal" Repeat="Never" Spacing="0,0" ItemAlignment="Far" /><Environment Name="Environment"/><BooleanChoice Name="Clicked" Value="false"/><shl:IntraSlideNavigationDirection IntraSlideNavigationDirection="Left" Name="LeftNavDirection"/><shl:IntraSlideNavigationDirection IntraSlideNavigationDirection="Right" Name="RightNavDirection"/></Locals><Rules><Default Target="[ScrollingHandler.ScrollingData]" Value="[ScrollingData]"/><Default Target="[ScrollingData.Repeater]" Value="[ListRepeater]"/><Rule><Conditions><Modified Source="[SlideDeck.Options]" /></Conditions><Actions><Invoke Target="[ListRepeater.ForceContentChange]" InvokePolicy="Synchronous" /><Invoke Target="[Scroller.ForceContentChange]" InvokePolicy="Synchronous" /></Actions></Rule><Binding Source="[SlideDeck.ChosenIndex]" Target="[ListRepeater.EssentialIndex]" /><Binding Source="[SlideDeck.Options]" Target="[ListRepeater.Source]" /><Rule><Conditions><Equality Source="[SlideDeck.AutoHideEnabled]" Value="true"/><Equality Source="[ScrollingHandler.IsPanning]" Value="true"/></Conditions><Actions><Invoke Target="[SlideDeck.AutoHideTimer.Start]" /></Actions></Rule><Rule><Conditions><Modified Source="[SlideDeck.CommandPrevSlide.Invoked]"/><Equality Source="[SlideDeck.ChosenIndex]" Value="0"/></Conditions><Actions><Invoke Target="[ListRepeater.AttachAnimation]" animation="animation://me:RepeaterMoveFarLeft" InvokePolicy="Synchronous" /></Actions></Rule><Rule><Conditions><Modified Source="[SlideDeck.CommandNextSlide.Invoked]"/></Conditions><Actions><Invoke Target="[ListRepeater.AttachAnimation]" animation="animation://me:RepeaterMoveRight" InvokePolicy="Synchronous" /><Set Target="[SlideDeck.SlideNavigationDirection]" Value="[RightNavDirection]"/></Actions></Rule><Rule><Conditions><Equality Source="[Clicked.Value]" Value="true"/><Equality Source="[SlideDeck.SlideNavigationDirection]" Value="[RightNavDirection]" /></Conditions><Actions><Invoke Target="[ListRepeater.AttachAnimation]" animation="animation://me:RepeaterMoveRight" InvokePolicy="Synchronous" /><Set Target="[Clicked.Value]" Value="false"/></Actions></Rule><Rule><Conditions><Modified Source="[SlideDeck.CommandNextSlide.Invoked]"/><Equality Source="[SlideDeck.ChosenIndex]" Value="[SlideDeck.Options.Count]"><SourceTransformer><MathTransformer AddInt="1"/></SourceTransformer></Equality></Conditions><Actions><Invoke Target="[ListRepeater.AttachAnimation]" animation="animation://me:RepeaterMoveFarRight" InvokePolicy="Synchronous" /></Actions></Rule><Rule><Conditions><Modified Source="[SlideDeck.CommandPrevSlide.Invoked]"/></Conditions><Actions><Invoke Target="[ListRepeater.AttachAnimation]" animation="animation://me:RepeaterMoveLeft" InvokePolicy="Synchronous" /><Set Target="[SlideDeck.SlideNavigationDirection]" Value="[LeftNavDirection]"/></Actions></Rule><Rule><Conditions><Equality Source="[Clicked.Value]" Value="true"/><Equality Source="[SlideDeck.SlideNavigationDirection]" Value="[LeftNavDirection]" /></Conditions><Actions><Invoke Target="[ListRepeater.AttachAnimation]" animation="animation://me:RepeaterMoveLeft" InvokePolicy="Synchronous" /><Set Target="[Clicked.Value]" Value="false"/></Actions></Rule><Rule><Conditions><Equality Source="[Environment.IsRightToLeft]" Value="false"/></Conditions><Actions><Set Target="[Scroller.ShowNear]" Value="false"/></Actions></Rule><Rule><Conditions><Equality Source="[Environment.IsRightToLeft]" Value="true"/></Conditions><Actions><Set Target="[Scroller.ShowFar]" Value="false"/></Actions></Rule></Rules><Content><Clip Name="SlideTitlePanel" Orientation="Vertical" ShowNear="false" ShowFar="true" FadeSize="[FadeSize]" FarOffset="0"><LayoutInput><AnchorLayoutInput Left="Parent,0" Bottom="Parent,1" Horizontal="Far" Vertical="Far" /></LayoutInput><Children><Scroller Name="Scroller" Orientation="Horizontal" ScrollingData="[ScrollingData]" Navigation="ContainHorizontal" PreferredAreaOfInterest="Selected" FadeSize="50" FarOffset="20"><Children><Repeater Name="ListRepeater" Source="[SlideDeck.Options]" Layout="[FlowLayout]" ><Content><me:ListItem TitleId="[RepeatedItem!shl:SlideBlueprint.Title!cor:String]" Index="[RepeatedItemIndex]" SlideDeck="[SlideDeck]" Color="[ItemColor]" Font="[ItemFont]" SelectedFont="[SelectedItemFont]" Clicked="[Clicked]" ItemMargins="[ItemMargins]"/></Content></Repeater></Children></Scroller><Panel Name="FillPanel" TouchInteractive="true"><LayoutInput><AnchorLayoutInput Left="Parent, 0" Right="Parent, 1" Top="Parent, 0" Bottom="Parent, 1" ContributesToWidth="false" ContributesToHeight="false"/></LayoutInput></Panel></Children></Clip></Content></UI><UI Name="ListItem"><Properties><cor:String Name="TitleId" String="$Required"/><Index Name="Index" Index="$Required" /><ucp:OverlaySlideDeck Name="SlideDeck" OverlaySlideDeck="$Required" /><BooleanChoice Name="Clicked" BooleanChoice="$Required"/><Font Name="Font" Font="$Required"/><Font Name="SelectedFont" Font="$Required"/><Color Name="Color" Color="color://comm:OffWhite"/><Inset Name="ItemMargins" Inset="0,0,0,0"/><Inset Name="SelectedItemMargins" Inset="0,0,36,0"/></Properties><Locals><AreaOfInterestLayoutInput Name="AreaOfInterest" Id="Selected"/><ClickHandler Name="Clicker"/><shl:IntraSlideNavigationDirection IntraSlideNavigationDirection="Left" Name="LeftNavDirection"/><shl:IntraSlideNavigationDirection IntraSlideNavigationDirection="Right" Name="RightNavDirection"/></Locals><Rules><Default Target="[Input.KeyInteractive]" Value="false"/><Rule><Conditions><Equality Source="[SlideDeck.ChosenIndex]" Value="[Index.SourceValue!cor:Int32]" /></Conditions><Actions><Invoke Target="[TextSlideName.SetLayoutInput]" oNewValue="[AreaOfInterest]" InvokePolicy="Synchronous"/><Set Target="[TextSlideName.Font]" Value="[SelectedFont]"/><Set Target="[TextSlideName.Margins]" Value="[SelectedItemMargins]"/><Set Target="[TextSlideName.Alpha]" Value="1.0"/></Actions></Rule><Rule><Conditions><Equality Source="[SlideDeck.ChosenIndex]" Value="[Index.SourceValue!cor:Int32]" ConditionOp="NotEquals" /></Conditions><Actions><Invoke Target="[TextSlideName.SetLayoutInput]" idInput="[AreaOfInterest!ILayoutData.Data]" oNewValue="null" InvokePolicy="Synchronous"/><Set Target="[TextSlideName.Font]" Value="[Font]"/></Actions></Rule><Rule><Conditions><Modified Source="[Clicker.Invoked]"/></Conditions><Actions><Set Target="[SlideDeck.ChosenIndex]" Value="[Index.SourceValue]"/><Set Target="[Clicked.Value]" Value="true"/></Actions></Rule><Rule><Conditions><Modified Source="[Clicker.Invoked]"/><Equality Source="[SlideDeck.ChosenIndex]" Value="[SlideDeck.PreviousChosenIndex]" ConditionOp="LessThan"/></Conditions><Actions><Set Target="[SlideDeck.SlideNavigationDirection]" Value="[LeftNavDirection]"/></Actions></Rule><Rule><Conditions><Modified Source="[Clicker.Invoked]"/><Equality Source="[SlideDeck.ChosenIndex]" Value="[SlideDeck.PreviousChosenIndex]" ConditionOp="GreaterThan"/></Conditions><Actions><Set Target="[SlideDeck.SlideNavigationDirection]" Value="[RightNavDirection]"/></Actions></Rule><Changed Source="[TitleId]" InitialEvaluate="true"><Actions><Invoke Target="[SlideDeck.GetString]" id="[TitleId]" ResultTarget="[TextSlideName.Content]" InvokePolicy="Synchronous"><Transformer><FormatTransformer Format="{0}" ToLower="true"/></Transformer></Invoke></Actions></Changed><Condition Source="[Input.DeepMouseFocus]" SourceValue="true" Target="[TextSlideName.Alpha]" Value="1.0"/><Default Target="[TextSlideName.Alpha]" Value="0.75"/></Rules><Content><Text Name="TextSlideName" Font="[Font]" Color="[Color]" Margins="[ItemMargins]"></Text></Content></UI><Animation Name="RepeaterMoveFarRight" Type="Move" Intensity="Intensive"><Keyframes><PositionKeyframe Time="0" Value="806,0,0" Interpolation="Sine"/><PositionKeyframe Time="0.3" Value="10,0,0" Interpolation="Log"/><PositionKeyframe Time="0.7" Value="0,0,0" RelativeTo="Final"/></Keyframes></Animation><Animation Name="RepeaterMoveRight" Type="Move" Intensity="Intensive"><Keyframes><PositionKeyframe Time="0" Value="202,0,0" Interpolation="Sine"/><PositionKeyframe Time="0.3" Value="10,0,0" Interpolation="Log"/><PositionKeyframe Time="0.7" Value="0,0,0" RelativeTo="Final"/></Keyframes></Animation><Animation Name="RepeaterMoveFarLeft" Type="Move" Intensity="Intensive"><Keyframes><PositionKeyframe Time="0" Value="-202,0,0" Interpolation="Sine"/><PositionKeyframe Time="0.3" Value="-10,0,0" Interpolation="Log"/><PositionKeyframe Time="0.7" Value="0,0,0" RelativeTo="Final"/></Keyframes></Animation><Animation Name="RepeaterMoveLeft" Type="Move" Intensity="Intensive"><Keyframes><PositionKeyframe Time="0" Value="-202,0,0" Interpolation="Sine"/><PositionKeyframe Time="0.3" Value="-10,0,0" Interpolation="Log"/><PositionKeyframe Time="0.7" Value="0,0,0" RelativeTo="Final"/></Keyframes></Animation></Mcml>