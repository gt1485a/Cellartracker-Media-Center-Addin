<Mcml xmlns="http://schemas.microsoft.com/2006/mcml" xmlns:cor ="assembly://MsCorLib/System" xmlns:shl ="assembly://Microsoft.MediaCenter.Shell/Microsoft.MediaCenter.Shell" xmlns:comm="res://Microsoft.MediaCenter.Shell!Globals.mcml" xmlns:me ="Me"><Aggregate Source="res://Microsoft.MediaCenter.Shell!StartMenuQuickLinkStrip.mcml"/><UI Name="StartMenuCategoryView"><Properties><shl:StartMenu Name="Model" StartMenu="$Required"/><shl:StartMenuCategory Name="Option" StartMenuCategory="$Required"/><shl:StartMenuCategoryPanHandler Name="StartMenuCategoryPanHandler" StartMenuCategoryPanHandler="$Required"/><Index Name="Index" Index="$Required"/><EditableText Name="NavigationDirection" EditableText="$Required"/><EditableText Name="QuickLinkMode" EditableText="$Required"/><BooleanChoice Name="LaunchFlag" BooleanChoice="$Required"/><BooleanChoice Name="Arriving" BooleanChoice="$Required"/><BooleanChoice Name="IsOverlay" BooleanChoice="$Required"/><cor:Single Name="MenuDelay" Single="0.0"/><Font Name="Font" FontName="global://comm:LightFontFace" FontSize="44"/><Color Name="NoFocusColor" Color="color://comm:LightBlue"/><Color Name="IncomingColor" Color="color://comm:OffWhite"/><Color Name="FocusColor" Color="color://comm:OffWhite"/><cor:Int32 Name="LimitAbove" Int32="2"/><cor:Int32 Name="LimitBelow" Int32="2"/><cor:Int32 Name="LeftAutoScrollEdgeOffset"/><cor:Int32 Name="RightAutoScrollEdgeOffset"/></Properties><Locals><Environment Name="Environment"/><Command Name="Command"/><ClickHandler Name="Clicker"/><AreaOfInterestLayoutInput Name="AreaOfInterest" Id="Selection"/><cor:Boolean Name="IsSelected" Boolean="false"/><Timer Name="MoveDelay" Interval="250" AutoRepeat="false" Enabled="false"/><cor:Int32 Name="StepOffset"/><cor:Single Name="DelayTime"/><MathTransformer Name="CalcOffset" Absolute="true"/><MathTransformer Name="ZStep" Multiply="0.067" Type="Single"/><MathTransformer Name="MainDelay"/><MathTransformer Name="CalcSign" Sign="true"/><cor:Int32 Name="HideSign" Int32="-9999"/><TransformAnimation Name="LabelAnimation" Source="global://me:Start.Category.Launch"/><TransformAnimation Name="HideAnimation" Source="animation://me:Start.Category.Collapse.Straight"/><TransformAnimation Name="LinkAnimation" Source="global://me:Start.LinkStrip.Launch"/><Color Name="FocusFillColor" Color="color://comm:Yellow"/><Color Name="NoFocusFillColor" Color="color://comm:OffWhite"/><Timer Name="ArrivingDetachTimer" AutoRepeat="false" Interval="1500" Enabled="false"/></Locals><Rules><Condition Source="[QuickLinkMode.Value]" SourceValue="Reset"><Actions><Set Target="[HideSign]" Value="-9999"/><Invoke Target="[LabelPosition.DetachAnimation]" type="Hide" InvokePolicy="AsynchronousLowPri"/></Actions></Condition><Condition Source="[QuickLinkMode.Value]" SourceValue="Select"><Actions><Set Target="[CalcSign.SubtractInt]" Value="[Model.SelectedCategoryIndex.Value]"/><Set Target="[HideSign]" Value="[Index.Value]" Transformer="[CalcSign]"/><Set Target="[CalcOffset.SubtractInt]" Value="[Model.SelectedCategoryIndex.Value]"/><Set Target="[StepOffset]" Value="[Index.Value]" Transformer="[CalcOffset]"/><Set Target="[HideAnimation.Delay]" Value="[StepOffset]"><Transformer><MathTransformer Multiply="0.033" Type="Single"/></Transformer></Set><Invoke Target="[LabelPosition.DetachAnimation]" type="Hide" InvokePolicy="Synchronous"/></Actions></Condition><Rule><Conditions><Equality Source="[HideSign]" Value="-1"/><Equality Source="[StepOffset]" ConditionOp="LessThanOrEquals" Value="[LimitAbove]"/></Conditions><Actions><Set Target="[HideAnimation.Source]" Value="animation://me:Start.Category.Collapse.Down"/><Invoke Target="[LabelPosition.AttachAnimation]" animation="[HideAnimation]" InvokePolicy="Synchronous" ExclusiveApply="false"/></Actions></Rule><Condition Source="[HideSign]" SourceValue="0"><Actions><Set Target="[HideAnimation.Source]" Value="animation://me:Start.Category.Collapse.Straight"/><Invoke Target="[LabelPosition.AttachAnimation]" animation="[HideAnimation]" InvokePolicy="Synchronous" ExclusiveApply="false"/></Actions></Condition><Rule><Conditions><Equality Source="[HideSign]" Value="1"/><Equality Source="[StepOffset]" ConditionOp="LessThanOrEquals" Value="[LimitBelow]"/></Conditions><Actions><Set Target="[HideAnimation.Source]" Value="animation://me:Start.Category.Collapse.Up"/><Invoke Target="[LabelPosition.AttachAnimation]" animation="[HideAnimation]" InvokePolicy="Synchronous" ExclusiveApply="false"/></Actions></Rule><Rule><Conditions><Equality Source="[LaunchFlag.Value]" Value="false"/><Equality Source="[Arriving.Value]" Value="true"/></Conditions><Actions><Set Target="[CalcOffset.SubtractInt]" Value="[Model.SelectedCategoryIndex.Value]"/><Set Target="[StepOffset]" Value="[Index.Value]" Transformer="[CalcOffset]"/><Set Target="[DelayTime]" Value="[StepOffset]" Transformer="[ZStep]"/><Set Target="[MainDelay.Add]" Value="[MenuDelay]"/><Set Target="[LabelAnimation.Delay]" Value="[DelayTime]" Transformer="[MainDelay]"/><Set Target="[LabelAnimation.Source]" Value="global://me:Start.Category.Return"/><Invoke Target="[LabelPosition.AttachAnimation]" animation="global://me:Start.Category.Return" InvokePolicy="AsynchronousNormal" ExclusiveApply="true"/><Set Target="[LinkAnimation.Source]" Value="global://me:Start.LinkStrip.Return"/><Set Target="[LinkAnimation.Delay]" Value="[MenuDelay]"/></Actions></Rule><Rule><Conditions><Equality Source="[LaunchFlag.Value]" Value="true"/><Equality Source="[Arriving.Value]" Value="true"/></Conditions><Actions><Set Target="[CalcOffset.SubtractInt]" Value="[Model.SelectedCategoryIndex.Value]"/><Set Target="[StepOffset]" Value="[Index.Value]" Transformer="[CalcOffset]"/><Set Target="[DelayTime]" Value="[StepOffset]" Transformer="[ZStep]"/><Set Target="[MainDelay.Add]" Value="[MenuDelay]"/><Set Target="[LabelAnimation.Delay]" Value="[DelayTime]" Transformer="[MainDelay]"/><Invoke Target="[LabelPosition.AttachAnimation]" animation="[LabelAnimation]" InvokePolicy="Synchronous" ExclusiveApply="false"/><Set Target="[LinkAnimation.Delay]" Value="[MenuDelay]"/></Actions></Rule><Rule><Conditions><Equality Source="[Arriving.Value]" Value="false"/></Conditions><Actions><Set Target="[ArrivingDetachTimer.Enabled]" Value="true"/></Actions></Rule><Changed Source="[ArrivingDetachTimer.Tick]"><Actions><Invoke Target="[LabelPosition.DetachAnimation]" type="Show" InvokePolicy="AsynchronousLowPri"/></Actions></Changed><Binding Target="[Accessible.IsPressed]" Source="[Clicker.Clicking]"/><Binding Target="[Accessible.IsFocusable]" Source="[Input.KeyInteractive]"/><Binding Target="[Accessible.IsFocused]" Source="[Input.KeyFocus]"/><Binding Target="[Accessible.Name]" Source="[Option.Description]"/><Default Target="[Accessible.DefaultActionCommand]" Value="[Command]"/><Default Target="[Accessible.DefaultAction]" Value="res://ehres!Acc_DefaultAction_Button"/><Default Target="[Accessible.Role]" Value="PushButton"/><Default Target="[Accessible.UniqueId]" Value="[Option.UniqueId]"/><Changed Source="[Clicker.Invoked]"><Actions><PlaySound Sound="res://ehres!MiniSelect_a.wav"/></Actions></Changed><Rule><Conditions><Modified Source="[Clicker.Invoked]"/><Equality Source="[Index.Value]" ConditionOp="LessThan" Value="[Model.SelectedCategoryIndex.Value]"/></Conditions><Actions><Set Target="[NavigationDirection.Value]" Value="none" ExclusiveApply="false"/><Set Target="[NavigationDirection.Value]" Value="up"/></Actions></Rule><Rule><Conditions><Modified Source="[Clicker.Invoked]"/><Equality Source="[Index.Value]" ConditionOp="GreaterThan" Value="[Model.SelectedCategoryIndex.Value]"/></Conditions><Actions><Set Target="[NavigationDirection.Value]" Value="none" ExclusiveApply="false"/><Set Target="[NavigationDirection.Value]" Value="down"/></Actions></Rule><Condition Source="[Input.MouseFocus]" SourceValue="true"><Actions><Invoke Target="[LabelPosition.DetachAnimation]" type="Alpha" InvokePolicy="Synchronous"/><Set Target="[Label.Color]" Value="[FocusColor]"/></Actions></Condition><Binding Source="[Option.Description]" Target="[Label.Content]"/><Changed Source="[Command.Invoked]"><Actions><Set Target="[Model.SelectedCategoryIndex.Value]" Value="[Index.Value]"/></Actions></Changed><Changed Source="[Model.SelectedCategoryIndex.Value]" InitialEvaluate="true"><Conditions><Equality Source="[Model.SelectedCategoryIndex.Value]" Value="[Index.Value]"/><Equality Source="[Index.Value]" Value="[Model.SelectedCategoryIndex.Value]"/></Conditions><Actions><Invoke Target="[Placeholder.SetLayoutInput]" oNewValue="[AreaOfInterest]" InvokePolicy="Synchronous"/></Actions></Changed><Changed Source="[Model.SelectedCategoryIndex.Value]"><Conditions><Equality Source="[Model.SelectedCategoryIndex.Value]" ConditionOp="NotEquals" Value="[Index.Value]"/><Equality Source="[Index.Value]" ConditionOp="NotEquals" Value="[Model.SelectedCategoryIndex.Value]"/></Conditions><Actions><Invoke Target="[Placeholder.SetLayoutInput]" idInput="[AreaOfInterest!ILayoutData.Data]" oNewValue="null" InvokePolicy="Synchronous"/></Actions></Changed><Changed Source="[StartMenuCategoryPanHandler.RatchetOffset]"><Conditions><Equality Source="[StartMenuCategoryPanHandler.IsPanning]" Value="true"/><Equality Source="[Model.SelectedCategoryIndex.Value]" ConditionOp="NotEquals" Value="[Index.Value]"/><Equality Source="[Index.Value]" ConditionOp="NotEquals" Value="[Model.SelectedCategoryIndex.Value]"/><Equality Source="[StartMenuCategoryPanHandler.IncomingIndex]" ConditionOp="NotEquals" Value="[Index.Value]"/></Conditions><Actions><Set Target="[Root.MaximumSize]" Value="[StartMenuCategoryPanHandler.NotSelectedCategorySize]"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.NotSelectedCategoryTitleInset]"/><Set Target="[Label.Alpha]" Value="[StartMenuCategoryPanHandler.NotSelectedCategoryTitleAlpha]"/><Set Target="[Label.Color]" Value="[NoFocusColor]"/></Actions></Changed><Rule><Conditions><Equality Source="[Model.SelectedCategoryIndex.Value]" ConditionOp="NotEquals" Value="[Index.Value]"/><Equality Source="[Index.Value]" ConditionOp="NotEquals" Value="[Model.SelectedCategoryIndex.Value]"/><Equality Source="[StartMenuCategoryPanHandler.IncomingIndex]" ConditionOp="NotEquals" Value="[Index.Value]"/><Equality Source="[StartMenuCategoryPanHandler.IsPanning]" Value="false"/></Conditions><Actions><Set Target="[Root.MaximumSize]" Value="[StartMenuCategoryPanHandler.NotSelectedCategorySize]"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.NotSelectedCategoryTitleInset]"/><Set Target="[Label.Alpha]" Value="[StartMenuCategoryPanHandler.NotSelectedCategoryTitleAlpha]"/><Set Target="[Label.Color]" Value="[NoFocusColor]"/></Actions></Rule><Changed Source="[StartMenuCategoryPanHandler.RatchetOffset]" InitialEvaluate="true"><Conditions><Equality Source="[StartMenuCategoryPanHandler.IncomingIndex]" Value="[Index.Value]"/></Conditions><Actions><Set Target="[Root.MaximumSize]" Value="[StartMenuCategoryPanHandler.AdjustedIncomingCategorySize]"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.AdjustedIncomingCategoryTitleInset]"/><Set Target="[Label.Alpha]" Value="[StartMenuCategoryPanHandler.AdjustedIncomingCategoryTitleAlpha]"/><Set Target="[Label.Color]" Value="[NoFocusColor]"/></Actions></Changed><Changed Source="[StartMenuCategoryPanHandler.RatchetOffset]"><Conditions><Equality Source="[StartMenuCategoryPanHandler.IsPanning]" Value="true"/><Equality Source="[Model.SelectedCategoryIndex.Value]" Value="[Index.Value]"/><Equality Source="[Index.Value]" Value="[Model.SelectedCategoryIndex.Value]"/></Conditions><Actions><Set Target="[Root.MaximumSize]" Value="[StartMenuCategoryPanHandler.AdjustedSelectedCategorySize]"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.AdjustedSelectedCategoryTitleInset]"/><Set Target="[Label.Alpha]" Value="[StartMenuCategoryPanHandler.AdjustedSelectedCategoryTitleAlpha]"/><Set Target="[Label.Color]" Value="[FocusColor]"/><Invoke Target="[Label.ForceContentChange]" InvokePolicy="Synchronous" ExclusiveApply="false"/><Invoke Target="[Root.MarkLayoutInvalid]" InvokePolicy="Synchronous"/></Actions></Changed><Rule><Conditions><Equality Source="[Model.SelectedCategoryIndex.Value]" Value="[Index.Value]"/><Equality Source="[Index.Value]" Value="[Model.SelectedCategoryIndex.Value]"/><Equality Source="[StartMenuCategoryPanHandler.IsPanning]" Value="false"/></Conditions><Actions><Set Target="[Root.MaximumSize]" Value="[StartMenuCategoryPanHandler.AdjustedSelectedCategorySize]"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.AdjustedSelectedCategoryTitleInset]"/><Set Target="[Label.Alpha]" Value="[StartMenuCategoryPanHandler.AdjustedSelectedCategoryTitleAlpha]"/><Set Target="[Label.Color]" Value="[FocusColor]"/><Invoke Target="[Label.ForceContentChange]" InvokePolicy="Synchronous" ExclusiveApply="false"/><Invoke Target="[Root.MarkLayoutInvalid]" InvokePolicy="Synchronous"/></Actions></Rule><Rule><Conditions><Equality Source="[Model.SelectedCategoryIndex.Value]" ConditionOp="NotEquals" Value="[Index.Value]"/><Equality Source="[Index.Value]" ConditionOp="NotEquals" Value="[Model.SelectedCategoryIndex.Value]"/><Equality Source="[StartMenuCategoryPanHandler.IncomingIndex]" ConditionOp="NotEquals" Value="[Index.Value]"/><Equality Source="[IsSelected]" Value="true"/><Equality Source="[Environment.Is2DAnimationExperience]" Value="false"/></Conditions><Actions><Invoke Target="[LabelPosition.AttachAnimation]" animation="animation://me:Start.Category.LoseFocus.Margin" InvokePolicy="Synchronous" ExclusiveApply="false"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.NotSelectedCategoryTitleInset]" ExclusiveApply="false"/><Invoke Target="[Label.ForceContentChange]" InvokePolicy="Synchronous" ExclusiveApply="false"/></Actions></Rule><Rule><Conditions><Equality Source="[Model.SelectedCategoryIndex.Value]" ConditionOp="NotEquals" Value="[Index.Value]"/><Equality Source="[Index.Value]" ConditionOp="NotEquals" Value="[Model.SelectedCategoryIndex.Value]"/><Equality Source="[StartMenuCategoryPanHandler.IncomingIndex]" ConditionOp="NotEquals" Value="[Index.Value]"/><Equality Source="[IsSelected]" Value="true"/><Equality Source="[Environment.Is2DAnimationExperience]" Value="true"/></Conditions><Actions><Invoke Target="[LabelPosition.AttachAnimation]" animation="animation://me:Start.Category.LoseFocus.Margin" InvokePolicy="Synchronous" ExclusiveApply="false"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.NotSelectedCategoryTitleInset]" ExclusiveApply="false"/><Invoke Target="[Label.ForceContentChange]" InvokePolicy="Synchronous" ExclusiveApply="false"/></Actions></Rule><Rule><Conditions><Equality Source="[Model.SelectedCategoryIndex.Value]" Value="[Index.Value]"/><Equality Source="[Index.Value]" Value="[Model.SelectedCategoryIndex.Value]"/><Equality Source="[Environment.Is2DAnimationExperience]" Value="false"/></Conditions><Actions><Invoke Target="[LabelPosition.AttachAnimation]" animation="animation://me:Start.Category.GainFocus.Margin" InvokePolicy="Synchronous" ExclusiveApply="false"/><Invoke Target="[Label.AttachAnimation]" animation="animation://me:Start.Category.GainFocus.ChangeShow" InvokePolicy="Synchronous" ExclusiveApply="false"/><Invoke Target="[Label.AttachAnimation]" animation="animation://me:Start.Category.GainFocus.ChangeHide" InvokePolicy="Synchronous" ExclusiveApply="false"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.SelectedCategoryTitleInset]"/><Set Target="[Label.Alpha]" Value="[StartMenuCategoryPanHandler.SelectedCategoryTitleAlpha]"/><Set Target="[Label.Color]" Value="[FocusColor]"/><Invoke Target="[Label.ForceContentChange]" InvokePolicy="Synchronous"/><Set Target="[IsSelected]" Value="true"/></Actions></Rule><Rule><Conditions><Equality Source="[Model.SelectedCategoryIndex.Value]" Value="[Index.Value]"/><Equality Source="[Index.Value]" Value="[Model.SelectedCategoryIndex.Value]"/><Equality Source="[Environment.Is2DAnimationExperience]" Value="true"/></Conditions><Actions><Invoke Target="[LabelPosition.AttachAnimation]" animation="animation://me:Start.Category.GainFocus.Margin" InvokePolicy="Synchronous" ExclusiveApply="false"/><Invoke Target="[Label.AttachAnimation]" animation="animation://me:Start.Category.GainFocus.ChangeShow" InvokePolicy="Synchronous" ExclusiveApply="false"/><Invoke Target="[Label.AttachAnimation]" animation="animation://me:Start.Category.GainFocus.ChangeHide" InvokePolicy="Synchronous" ExclusiveApply="false"/><Set Target="[LabelPosition.Margins]" Value="[StartMenuCategoryPanHandler.SelectedCategoryTitleInset]"/><Set Target="[Label.Alpha]" Value="[StartMenuCategoryPanHandler.SelectedCategoryTitleAlpha]"/><Set Target="[Label.Color]" Value="[FocusColor]"/><Invoke Target="[Label.ForceContentChange]" InvokePolicy="Synchronous"/><Set Target="[IsSelected]" Value="true"/></Actions></Rule><Default Target="[IsSelected]" Value="false"/><Rule><Conditions><Equality Source="[Environment.IsNavigating]" Value="true"/><Equality Source="[Environment.NavigationDirection]" Value="Backward"/><Equality Source="[IsOverlay.Value]" Value="false"/></Conditions><Actions><Invoke Target="[LabelPosition.AttachAnimation]" animation="animation://me:Start.Category.Hide.Back" InvokePolicy="Synchronous"/></Actions></Rule><Rule><Conditions><Equality Source="[Environment.IsNavigating]" Value="true"/><Equality Source="[Environment.NavigationDirection]" Value="Backward"/><Equality Source="[IsOverlay.Value]" Value="true"/></Conditions><Actions><Invoke Target="[LabelPosition.AttachAnimation]" animation="animation://me:Start.Category.Hide.Overlay" InvokePolicy="Synchronous" ExclusiveApply="false"/></Actions></Rule><Default Target="[Input.KeyInteractive]" Value="false"/><Default Target="[Clicker.Command]" Value="[Command]"/></Rules><Content><Panel Name="Root" Visible="true" MaximumSize="[StartMenuCategoryPanHandler.NotSelectedCategorySize]"><Layout><AnchorLayout SizeToVerticalChildren="false"/></Layout><Animations><Animation Animation="animation://me:Start.Category.Move"/></Animations><Children><Panel Name="LabelPosition" Margins="[StartMenuCategoryPanHandler.NotSelectedCategoryTitleInset]"><LayoutInput><AnchorLayoutInput Top="Parent, 0, -20" Left="Parent, 0"/></LayoutInput><Animations><Animation Animation="animation://me:Start.Category.Hide.Overlay"/></Animations><Children><FancyText Name="Label" Color="[NoFocusColor]" Font="[Font]" Alpha="[StartMenuCategoryPanHandler.SelectedCategoryTitleAlpha]" MouseInteractive="true"/></Children></Panel><Panel Name="Placeholder"><LayoutInput><FormLayoutInput Top="Parent, 0, 56" Left="Parent, 0" Right="Parent, 1" Bottom="Parent, 1"/></LayoutInput></Panel></Children></Panel></Content></UI></Mcml>